{% from '@SyliusShop/Common/Macro/breadcrumb.html.twig' import breadcrumb %}
{% set crumbs = [] %}
{% if product.mainTaxon is not null %}
    {% set taxon = product.mainTaxon %}
    {% set ancestors = taxon.ancestors|reverse %}

    {% for ancestor in ancestors %}
        {% if not ancestor.isRoot() %}
            {% set crumbs = crumbs|merge([{
                url: path('sylius_shop_product_index', {'slug': ancestor.slug, '_locale': ancestor.translation.locale}),
                name: ancestor.name
            }]) %}
        {% endif %}
    {% endfor %}
    {% set crumbs = crumbs|merge([{
        url: path('sylius_shop_product_index', {'slug': taxon.slug, '_locale': taxon.translation.locale}),
        name: taxon.name
    }]) %}
{% endif %}
{% set crumbs = crumbs|merge([{
    name: product.name
}]) %}
{{ breadcrumb(crumbs) }}
