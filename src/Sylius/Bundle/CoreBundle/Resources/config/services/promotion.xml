<?xml version="1.0" encoding="UTF-8"?>

<!--

 This file is part of the Sylius package.

 (c) Paweł Jędrzejewski

 For the full copyright and license information, please view the LICENSE
 file that was distributed with this source code.

-->

<container xmlns="http://symfony.com/schema/dic/services"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="http://symfony.com/schema/dic/services
                               http://symfony.com/schema/dic/services/services-1.0.xsd">

    <parameters>
        <parameter key="sylius.active_promotions_by_channel_provider.class">Sylius\Component\Core\Provider\ActivePromotionsByChannelProvider</parameter>

        <parameter key="sylius.promotion_rule_checker.nth_order.class">Sylius\Component\Core\Promotion\Checker\NthOrderRuleChecker</parameter>
        <parameter key="sylius.promotion_rule_checker.customer_loyalty.class">Sylius\Component\Core\Promotion\Checker\CustomerLoyaltyRuleChecker</parameter>
        <parameter key="sylius.promotion_rule_checker.shipping_country.class">Sylius\Component\Core\Promotion\Checker\ShippingCountryRuleChecker</parameter>
        <parameter key="sylius.promotion_rule_checker.taxon.class">Sylius\Component\Core\Promotion\Checker\TaxonRuleChecker</parameter>
        <parameter key="sylius.promotion_rule_checker.contains_product.class">Sylius\Component\Core\Promotion\Checker\ContainsProductRuleChecker</parameter>
        <parameter key="sylius.promotion_rule_checker.customer_group.class">Sylius\Component\Core\Promotion\Checker\CustomerGroupRuleChecker</parameter>
        <parameter key="sylius.promotion_action.fixed_discount.class">Sylius\Component\Core\Promotion\Action\FixedDiscountAction</parameter>
        <parameter key="sylius.promotion_action.item_fixed_discount.class">Sylius\Component\Core\Promotion\Action\ItemFixedDiscountAction</parameter>
        <parameter key="sylius.promotion_action.percentage_discount.class">Sylius\Component\Core\Promotion\Action\PercentageDiscountAction</parameter>
        <parameter key="sylius.promotion_action.item_percentage_discount.class">Sylius\Component\Core\Promotion\Action\ItemPercentageDiscountAction</parameter>
        <parameter key="sylius.promotion_action.shipping_discount.class">Sylius\Component\Core\Promotion\Action\ShippingDiscountAction</parameter>
        <parameter key="sylius.promotion_action.add_product.class">Sylius\Component\Core\Promotion\Action\AddProductAction</parameter>
        <parameter key="sylius.promotion_eligibility_checker.class">Sylius\Component\Core\Promotion\Checker\PromotionEligibilityChecker</parameter>

        <parameter key="sylius.promotion_filter.taxon.class">Sylius\Component\Core\Promotion\Filter\TaxonFilter</parameter>
        <parameter key="sylius.promotion_filter.price_range.class">Sylius\Component\Core\Promotion\Filter\PriceRangeFilter</parameter>
    </parameters>

    <services>
        <service id="sylius.active_promotions_by_channel_provider" class="%sylius.active_promotions_by_channel_provider.class%">
            <argument type="service" id="sylius.repository.promotion" />
        </service>

        <service id="sylius.promotion_processor" class="%sylius.promotion_processor.class%">
            <argument type="service" id="sylius.active_promotions_by_channel_provider" />
            <argument type="service" id="sylius.promotion_eligibility_checker" />
            <argument type="service" id="sylius.promotion_applicator" />
        </service>

        <service id="sylius.promotion_rule_checker.nth_order" class="%sylius.promotion_rule_checker.nth_order.class%">
            <argument type="service" id="sylius.repository.order" />
            <tag name="sylius.promotion_rule_checker" type="nth_order" label="Nth order" />
        </service>
        <service id="sylius.promotion_rule_checker.customer_loyalty" class="%sylius.promotion_rule_checker.customer_loyalty.class%">
            <tag name="sylius.promotion_rule_checker" type="customer_loyalty" label="Customer loyalty" />
        </service>
        <service id="sylius.promotion_rule_checker.shipping_country" class="%sylius.promotion_rule_checker.shipping_country.class%">
            <argument type="service" id="sylius.repository.country" />
            <tag name="sylius.promotion_rule_checker" type="shipping_country" label="Shipping country" />
        </service>
        <service id="sylius.promotion_rule_checker.taxon" class="%sylius.promotion_rule_checker.taxon.class%">
            <tag name="sylius.promotion_rule_checker" type="taxon" label="Taxon" />
        </service>
        <service id="sylius.promotion_rule_checker.contains_product" class="%sylius.promotion_rule_checker.contains_product.class%">
            <tag name="sylius.promotion_rule_checker" type="contains_product" label="Contains Product" />
        </service>
        <service id="sylius.promotion_rule_checker.customer_group" class="%sylius.promotion_rule_checker.customer_group.class%">
            <tag name="sylius.promotion_rule_checker" type="customer_group" label="User Group" />
        </service>
        <service id="sylius.promotion_action.fixed_discount" class="%sylius.promotion_action.fixed_discount.class%">
            <argument type="service" id="sylius.factory.adjustment" />
            <argument type="service" id="sylius.originator" />
            <tag name="sylius.promotion_action" type="order_fixed_discount" label="Order fixed discount" />
        </service>
        <service id="sylius.promotion_action.item_fixed_discount" class="%sylius.promotion_action.item_fixed_discount.class%">
            <argument type="service" id="sylius.factory.adjustment" />
            <argument type="service" id="sylius.originator" />
            <argument type="service" id="sylius.promotion_filter.price_range" />
            <argument type="service" id="sylius.promotion_filter.taxon" />
            <tag name="sylius.promotion_action" type="item_fixed_discount" label="Item fixed discount" />
        </service>
        <service id="sylius.promotion_action.percentage_discount" class="%sylius.promotion_action.percentage_discount.class%">
            <argument type="service" id="sylius.factory.adjustment" />
            <argument type="service" id="sylius.originator" />
            <tag name="sylius.promotion_action" type="order_percentage_discount" label="Order percentage discount" />
        </service>
        <service id="sylius.promotion_action.item_percentage_discount" class="%sylius.promotion_action.item_percentage_discount.class%">
            <argument type="service" id="sylius.factory.adjustment" />
            <argument type="service" id="sylius.originator" />
            <argument type="service" id="sylius.integer_distributor" />
            <argument type="service" id="sylius.promotion_filter.price_range" />
            <argument type="service" id="sylius.promotion_filter.taxon" />
            <tag name="sylius.promotion_action" type="item_percentage_discount" label="Item percentage discount" />
        </service>
        <service id="sylius.promotion_action.shipping_discount" class="%sylius.promotion_action.shipping_discount.class%">
            <argument type="service" id="sylius.factory.adjustment" />
            <argument type="service" id="sylius.originator" />
            <tag name="sylius.promotion_action" type="shipping_discount" label="Shipping discount" />
        </service>
        <service id="sylius.promotion_action.add_product" class="%sylius.promotion_action.add_product.class%">
            <argument type="service" id="sylius.factory.order_item" />
            <argument type="service" id="sylius.repository.product_variant" />
            <argument type="service" id="sylius.order_item_quantity_modifier" />
            <tag name="sylius.promotion_action" type="add_product" label="Add product" />
        </service>

        <service id="sylius.promotion_eligibility_checker" class="%sylius.promotion_eligibility_checker.class%">
            <argument type="service" id="sylius.repository.order" />
            <argument type="service" id="sylius.registry.promotion_rule_checker" />
            <argument type="service" id="event_dispatcher" />
        </service>

        <service id="sylius.promotion_filter.taxon" class="%sylius.promotion_filter.taxon.class%" />
        <service id="sylius.promotion_filter.price_range" class="%sylius.promotion_filter.price_range.class%" />
    </services>

</container>
